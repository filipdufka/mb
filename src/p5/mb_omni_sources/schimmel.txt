function L = pazs_c02_field5(area, step, sourcex, sourcey, R, f, vs, ph)

% osa x a y oblasti simulace
x=(area(1):step:area(2));
y=(area(3):step:area(4));

% pøíprava pole pro výsledný rychlostní potenciál
Phi = zeros(length(y),length(x));

% rychlost šíøení zvuku
c0 = 344;

% vlnové èíslo
k = 2*pi*f/c0;

% amplituda kmitání bodového zdroje
% všechny mají stejný polomìr, proto budou mít i stejnou výchozí amplitudu kmitání
A0 = -(R.^2)./(1+j*k*R).*exp(-j*k*R);

% výpoèet rychlostního potenciálu
for o = 1:length(sourcex)
    % amplituda a poèáteèní fáze o-tého zdroje
    A = vs(o).*exp(j.*ph(o));

    for m = 1:length(x)
        [th, r] = cart2pol(x(m)-sourcex(o), y-sourcey(o)); % r a th jsou radkove vektory
        r = r'; th = th'; % transpozice na sloupcove vektory
            
        % zamezení dìlení nulou v souøadnici zdroje
        r(r<step) = step; % {r<step) vrati vsechny indexy vekroru r, na kterych jsou hodnoty < step
        
        % rychlostni potencial o-teho zdroje v bode x(m),y(n)
        Phio = A.*exp(-j*k.*r)./r; % Phio je sloupcovy vektor
            
        % celkovy rychlostni potencial (soucet potencialu jednotlivych zdroju)
        Phi(:,m) = Phi(:,m) + Phio;
    end
end

% výpoèet akustického tlaku z rychlostního potenciálu
p = -j*2*-pi*f*Phi;

% výpoèet hladiny akustického tlaku
L = 20*log10(abs(p)/0.00002);
% omezení spodní hranice na práh slyšení
L(L<0) = 0;

% pause
maxZ=max(max(L));
% vykreslení pole
figure();
imagesc(x,y,L);
colormap;
axis image;
colorbar;
xlabel('{\itx} [m] \rightarrow');
ylabel('{\ity} [m] \rightarrow');
title('hladina akustickeho tlaku [dB_{SPL}]');